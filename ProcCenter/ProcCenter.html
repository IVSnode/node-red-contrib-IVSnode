<script type="text/x-red" data-template-name="procenter">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('procenter',{
        color:"#AAAA66",
        category: 'WebCMS',
        defaults: {
            name: {value:""},
            field: {value:"payload"},
            format: {value:"handlebars"},
            procenter: {value:"<html>\n<!--script src=\"dash.js\"></script-->\n<script type=\"text/javascript\" src=\"https://rawgit.com/j491424570/Dash/39698ac5bc9fabde703ee285ce0161c1fc6f9e8d/dash.js\"></script>\n<body>\n<script type=\"text/javascript\">\nvar wsUri = \"ws://{{req.headers.host}}/ws/video\";\nvar ws = new WebSocket(wsUri);\n\nws.onmessage = function(evt){\nalert(evt.data);\nvar result = evt.data.split(\"&\");\nvar state = result[0].split(\"=\");\nif (state[1] == \"OK\"){\nvar body = result[1].split(\"=\");\nalert(body[1]);\nsetupVideo1(body[1]);\n}\nelse\n{\nalert(state[1]);\n}\n}\n\nfunction setupVideo1(url)\n{\nvar context1 = new Dash.di.DashContext();\nvar player1 = new MediaPlayer(context1);\nplayer1.startup();\nplayer1.attachView(document.querySelector(\"#videoPlayer1\"));\nplayer1.attachSource(url);\nalert(url);\n}\nfunction setupVideo() \n{\nvar url = \"{{{payload}}}\";\nvar strs= new Array();\nstrs=url.split(\",\");\n//            alert(strs[0]);alert(strs[1]);alert(strs[2]);alert(strs[3]);\n//            alert(strs.length);\nvar context1 = new Dash.di.DashContext();\nvar player1 = new MediaPlayer(context1);\nplayer1.startup();\nplayer1.attachView(document.querySelector(\"#videoPlayer1\"));\nplayer1.attachSource(strs[0]);\nvar context2 = new Dash.di.DashContext();\nvar player2 = new MediaPlayer(context2);\nplayer2.startup();\nplayer2.attachView(document.querySelector(\"#videoPlayer2\"));\nplayer2.attachSource(strs[1]);\nvar context3 = new Dash.di.DashContext();\nvar player3 = new MediaPlayer(context3);\nplayer3.startup();\nplayer3.attachView(document.querySelector(\"#videoPlayer3\"));\nplayer3.attachSource(strs[2]);\nvar context4 = new Dash.di.DashContext();\nvar player4 = new MediaPlayer(context4);\nplayer4.startup();\nplayer4.attachView(document.querySelector(\"#videoPlayer4\"));\nplayer4.attachSource(strs[3]);\n}\n</script>\n<video id = \"videoPlayer1\" controls width = \"49%\" height = \"49%\"  >\nYour browser does not support the video tag.\n</video>\n<video id = \"videoPlayer2\" controls width = \"49%\" height = \"49%\" loop=\"loop\" >\nYour browser does not support the video tag.\n</video>\n<video id = \"videoPlayer3\" controls width = \"49%\" height = \"49%\" loop=\"loop\" >\nYour browser does not support the video tag.\n</video>\n<video id = \"videoPlayer4\" controls width = \"49%\" height = \"49%\" loop=\"loop\" >\nYour browser does not support the video tag.\n</video>\n<button onclick=\"StartPreview()\"  class=\"btn btn-success\" name=\"startPreview\" tabindex=\"1\" style=\"FONT-SIZE: large\">StartPreview</button>\n</body>\n</html>\n"},
        },
        inputs:1,
        outputs:1,
        icon: "procenter.png",
        label: function() {
            return this.name;
        },
    });
</script>
